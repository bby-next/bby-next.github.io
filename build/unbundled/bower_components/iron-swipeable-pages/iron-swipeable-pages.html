<html><head><link rel="import" href="../polymer/polymer.html">

<link rel="import" href="../iron-resizable-behavior/iron-resizable-behavior.html">
<link rel="import" href="../iron-selector/iron-selectable.html">



</head><body><dom-module id="iron-swipeable-pages">
  <style>
    :host {
      position: relative;
      display: block;
      overflow-x: hidden;
    }
    :host > ::content > * {
      position: absolute;
      width: 100%;
      height: 100%;
      overflow-y: auto;
      will-change: left, transform;
    }
    :host > ::content > :not(.iron-selected):not(.iron-swiping) {
      display: none !important;
    }
  </style>

  <template>
    <content></content>
  </template>

  <script>!function(){Polymer({is:"iron-swipeable-pages",behaviors:[Polymer.IronResizableBehavior,Polymer.IronSelectableBehavior],properties:{activateEvent:{type:String,readOnly:!0,value:null},padding:{type:Number,value:0},threshold:{type:Number,value:.3},noCycle:{type:Boolean,value:!1},transitionDuration:{type:Number,value:250},maximumTransitionDuration:{type:Number,value:0},transitionTimingFunction:{type:String,value:"cubic-bezier(0.4, 0.0, 0.2, 1)"},isGesture:{type:Boolean,value:!1},edgeSwipeSensitivity:{type:Number,value:0},disabled:{type:Boolean,value:!1}},listeners:{"iron-items-changed":"_onItemsChanged","iron-deselect":"_onIronDeselectItem","iron-select":"_onIronSelectItem","dom-change":"_onDomChange",track:"_onTrack"},ready:function(){this.setScrollDirection("y"),this._animatedPages=[]},_onItemsChanged:function(t){for(var e=t.detail,i=0;i<e.addedNodes.length;i++)this._addPage(e.addedNodes[i]);for(var s=0;s<e.removedNodes.length;s++)this._removePage(e.removedNodes[s])},_addPage:function(t){t&&t.nodeType===Node.ELEMENT_NODE&&(this.listen(t,"webkitTransitionEnd","_onTransitionEnd"),this.listen(t,"transitionend","_onTransitionEnd"))},_removePage:function(t){t&&t.nodeType===Node.ELEMENT_NODE&&(this.unlisten(t,"webkitTransitionEnd","_onTransitionEnd"),this.unlisten(t,"transitionend","_onTransitionEnd"))},_onDomChange:function(t){this.selectedItem&&0==this.selectedItem.offsetWidth&&(this.selected=this.fallbackSelection)},_onTrack:function(t){var e=t.detail;if(!(this.disabled||this.noCycle&&!this._canCycle(e)||e.x-e.dx<this.edgeSwipeSensitivity||e.x-e.dx>this.offsetWidth-this.edgeSwipeSensitivity))if("start"===e.state&&Math.abs(e.dy)<Math.abs(e.dx)){if(this.items.length<2)return;this._trackStart(e),this._swipeStarted=!0}else"track"===e.state&&this._swipeStarted?this._trackMove(e):"end"===e.state&&this._swipeStarted&&this._trackEnd(e)},_trackStart:function(t){this._transitionRunning&&this._resetPages(),this._setUpSwipePages(),this._animatePages(t.dx),this._switchPageIfNecessary(t.dx),window.addEventListener("touchmove",this._preventTouchMove)},_trackMove:function(t){this._animatePages(t.dx),this._switchPageIfNecessary(t.dx)},_trackEnd:function(t){if(this._swipeStarted){for(var e=0;e<this._animatedPages.length;e++)this._animatedPages[e].style.webkitTransition=this._computeTransition(1),this._animatedPages[e].style.transition=this._computeTransition(1);if(this._transitionRunning=!0,this._completeSwipe=Math.abs(t.dx)>this._getOffsetWidth()*this.threshold,this._completeSwipe){this.isGesture=!0;var i=t.dx>0;i?this._selectPage(this._leftCandidate):this._selectPage(this._rightCandidate),this._animatePages(i?this._getOffsetWidth():-this._getOffsetWidth())}else this._animatePages(0);window.removeEventListener("touchmove",this._preventTouchMove)}},_preventTouchMove:function(t){return t&&t.preventDefault()},_onIronDeselectItem:function(t){t.target===this&&(this._lastIndex=this.indexOf(t.detail.item))},_onIronSelectItem:function(t){if(t.target===this&&void 0!==this._lastIndex&&this._lastIndex!==-1){var e=this.indexOf(t.detail.item);if(this._completeSwipe)this._completeSwipe=!1;else if(this._transitionRunning)this._resetPages();else{this._animatedPages=[];var i=0;if(e<this._lastIndex)for(var s=this._lastIndex;s>=e;s--)this._initPage(this.items[s],this._computeTransition(this._lastIndex-e),this._getOffsetWidth()*(s-i-this._lastIndex)),0==this.items[s].offsetWidth&&(this._resetPage(this.items[s]),i--);else{i=0;for(var n=this._lastIndex;n<=e;n++)this._initPage(this.items[n],this._computeTransition(e-this._lastIndex),this._getOffsetWidth()*(n-i-this._lastIndex)),0==this.items[n].offsetWidth&&(this._resetPage(this.items[n]),i++)}this._transitionRunning=!0;var a=this._lastIndex;this.async(function(){this._animatePages((a-e+i)*this._getOffsetWidth())})}this.async(function(){var t=this.selectedItem;this.resizerShouldNotify=function(e){return e==t||t.contains(e)},this.notifyResize()})}},_setUpSwipePages:function(){this._animatedPages=[],this._initPage(this.selectedItem,"none",0);for(var t=0,e=!1;!e;){var i=(Number(this.indexOf(this.selectedItem))-1-t+this.items.length)%this.items.length;this._leftCandidate=this.items[i],this._initPage(this._leftCandidate,"none",-this._getOffsetWidth()),this._leftCandidate.offsetWidth>0?e=!0:(this._resetPage(this._leftCandidate),t++)}for(t=0,e=!1;!e;){var s=(Number(this.indexOf(this.selectedItem))+1+t)%this.items.length;this._rightCandidate=this.items[s],this._initPage(this._rightCandidate,"none",this._getOffsetWidth()),this._rightCandidate.offsetWidth>0?e=!0:(this._resetPage(this._rightCandidate),t++)}},_initPage:function(t,e,i){t&&(t.style.left=i+"px",t.style.webkitTransition=e,t.style.transition=e,this.toggleClass("iron-swiping",!0,t),this._animatedPages.push(t))},_animatePages:function(t){for(var e=0;e<this._animatedPages.length;e++)this.translate3d(t+"px","0px","0px",this._animatedPages[e])},_switchPageIfNecessary:function(t){if(this._leftCandidate&&this._rightCandidate&&this._leftCandidate===this._rightCandidate){var e=t>0?-1:1;this._rightCandidate.style.left=e*this._getOffsetWidth()+"px"}},_selectPage:function(t){var e=this.indexOf(t);this.selected=this._indexToValue(e)},_resetPage:function(t){t.style.left="0px",t.style.webkitTransition="none",t.style.transition="none",this.toggleClass("iron-swiping",!1,t),this._animatedPages.pop()},_resetPages:function(){for(var t=0;t<this._animatedPages.length;t++)this._animatedPages[t].style.left="0px",this._animatedPages[t].style.webkitTransition="none",this._animatedPages[t].style.transition="none",this.toggleClass("iron-swiping",!1,this._animatedPages[t]),this.transform("none",this._animatedPages[t]);this._transitionRunning=!1,this._swipeStarted=!1,this.isGesture=!1},_onTransitionEnd:function(t){this._resetPages()},_canCycle:function(t){var e=this._valueToIndex(this.selected);return!(0===e&&t.dx>0)&&!(e===this.items.length-1&&t.dx<0)},_getOffsetWidth:function(){return this.offsetWidth+2*this.padding},_computeTransition:function(t){var e=t*this.transitionDuration;return this.maximumTransitionDuration&&(e=Math.min(this.maximumTransitionDuration,e)),"transform "+e+"ms "+this.transitionTimingFunction}})}();</script>
</dom-module>
</body></html>